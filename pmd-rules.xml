<?xml version="1.0"?>
<ruleset name="GhidraMCP Rules"
         xmlns="http://pmd.sourceforge.net/ruleset/2.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://pmd.sourceforge.net/ruleset/2.0.0 https://pmd.sourceforge.io/ruleset_2_0_0.xsd">

  <description>Static analysis rules for GhidraMCP</description>

  <!-- Dead code detection -->
  <rule ref="category/java/bestpractices.xml/UnusedLocalVariable"/>
  <rule ref="category/java/bestpractices.xml/UnusedPrivateField"/>
  <rule ref="category/java/bestpractices.xml/UnusedPrivateMethod">
    <properties>
      <!-- PMD cannot detect method-reference usage (e.g. this::monitorTimeouts) -->
      <property name="violationSuppressXPath"
                value="//MethodDeclaration[@Name='monitorTimeouts']"/>
    </properties>
  </rule>
  <rule ref="category/java/bestpractices.xml/UnusedFormalParameter"/>
  <rule ref="category/java/bestpractices.xml/UnusedAssignment"/>

  <!-- Common bug patterns -->
  <rule ref="category/java/errorprone.xml/EmptyCatchBlock"/>
  <rule ref="category/java/errorprone.xml/AvoidBranchingStatementAsLastInLoop"/>
  <rule ref="category/java/errorprone.xml/CloseResource"/>
  <rule ref="category/java/errorprone.xml/ComparisonWithNaN"/>
  <rule ref="category/java/errorprone.xml/EqualsNull"/>
  <rule ref="category/java/errorprone.xml/ImplicitSwitchFallThrough"/>
  <rule ref="category/java/errorprone.xml/ReturnEmptyCollectionRatherThanNull"/>
  <rule ref="category/java/errorprone.xml/UnconditionalIfStatement"/>
  <rule ref="category/java/errorprone.xml/UnnecessaryCaseChange"/>

  <!-- Code quality -->
  <rule ref="category/java/design.xml/CollapsibleIfStatements"/>
  <rule ref="category/java/design.xml/SimplifiedTernary"/>
  <rule ref="category/java/design.xml/UselessOverridingMethod"/>

  <!-- Performance -->
  <rule ref="category/java/performance.xml/StringInstantiation"/>
  <rule ref="category/java/performance.xml/UseStringBufferForStringAppends"/>

  <!-- Immutability: prefer final for locals and parameters -->
  <rule ref="category/java/codestyle.xml/LocalVariableCouldBeFinal"/>
  <rule ref="category/java/codestyle.xml/MethodArgumentCouldBeFinal"/>

  <!-- Unnecessary code / LLM cruft -->
  <rule ref="category/java/codestyle.xml/UnnecessaryImport"/>
  <rule ref="category/java/codestyle.xml/UnnecessaryReturn"/>
  <rule ref="category/java/codestyle.xml/UnnecessaryModifier"/>
  <rule ref="category/java/codestyle.xml/UnnecessaryCast"/>
  <rule ref="category/java/codestyle.xml/UnnecessarySemicolon"/>
  <rule ref="category/java/codestyle.xml/UnnecessaryFullyQualifiedName"/>
  <rule ref="category/java/codestyle.xml/UnnecessaryBoxing"/>
  <rule ref="category/java/codestyle.xml/EmptyControlStatement"/>
  <rule ref="category/java/codestyle.xml/IdenticalCatchBranches"/>
</ruleset>
